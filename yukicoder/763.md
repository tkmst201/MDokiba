# [No.763 Noel ちゃんと木遊び](https://yukicoder.me/problems/no/763)

まず、連結成分が最大となっているときの状態を考えてみます。  
このとき、次の考察により、すべての連結成分が $1$ つの頂点のみからなるものが存在することが言えます。  

- 大きさが $3$ 以上の連結成分が存在する場合
	- その連結成分に含まれる端点以外の頂点を削除することにより連結成分を増やすことができるので最大性に矛盾します。
- 大きさが $2$ の連結成分が存在する場合
	- その中に含まれる適当な頂点を $1$ つ削除しても全体の連結成分の個数は変化しないので大きさが $1$ の連結成分にできます。

<br>

以下、頂点 $1$ を根とした木を考えます。葉の $1$ つを $u$ 、その親を $p$ とします。  
次の考察により、$u$ は削除されない、$p$ は削除されるとして良いことが言えます。  

- $p$ が削除されていない場合
	- 先程の考察から $p$ と隣り合う頂点はすべて削除されているので $u$ も削除されています。  
このとき、$p$ を削除、$u$ を削除しないようにしても他に影響を与えず連結成分の個数は変化しないので $p$ は削除されていると考えて良いです。  
- $u$ も $p$ も削除されている場合
	- $u$ を削除しないようにすれば連結成分が増えるので連結成分が最大となりません。  

この操作を繰り返すことにより答えを $\Theta(N)$ で求めることができます。  

実装は、子で $1$ つでも削除されない頂点が存在すれば自身を削除するという方針で、自身が削除されていないかどうかのフラグを返すようにして DFS をするのが簡単です。  

実装例(C++17 47ms): [https://yukicoder.me/submissions/616289](https://yukicoder.me/submissions/616289)